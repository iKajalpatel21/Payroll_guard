[{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\api\\axios.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\components\\Navbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\components\\PrivateRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\context\\AuthContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":50,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":50,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\AccountSettings.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\AdminDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\EmployeeDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\Login.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\ManagerPortal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\Onboarding.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":30,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport api from '../api/axios';\r\nimport './Auth.css'; // Reuse login styles for the clean centered card look\r\n\r\nconst Onboarding = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  // Form State\r\n  const [address, setAddress] = useState({ street: '', city: '', state: '', zip: '', country: 'US' });\r\n  const [bank, setBank] = useState({ accountNumber: '', routingNumber: '', bankName: '' });\r\n\r\n  // On mount, check if they actually need onboarding\r\n  useEffect(() => {\r\n    const checkStatus = async () => {\r\n      try {\r\n        const { data } = await api.get('/me/profile');\r\n        const emp = data.employee;\r\n        if (emp.bankAccount?.accountNumber) {\r\n          // They already have a baseline, redirect to dashboard\r\n          navigate(emp.role === 'MANAGER' ? '/manager' : emp.role === 'SECURITY_STAFF' ? '/staff' : '/dashboard');\r\n        } else {\r\n          setLoading(false);\r\n        }\r\n      } catch (err) {\r\n        setError('Failed to load profile. Please refresh.');\r\n        setLoading(false);\r\n      }\r\n    };\r\n    checkStatus();\r\n  }, [navigate]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setSubmitting(true);\r\n    setError('');\r\n    \r\n    // Simulate fingerprinting the device ID\r\n    let deviceId = localStorage.getItem('deviceId');\r\n    if (!deviceId) {\r\n      deviceId = 'dev_' + Math.random().toString(36).substr(2, 9);\r\n      localStorage.setItem('deviceId', deviceId);\r\n    }\r\n\r\n    try {\r\n      await api.post('/me/baseline', {\r\n        newAddress: address,\r\n        newBankDetails: bank,\r\n        deviceId\r\n      });\r\n      // Redirect to correct dashboard based on role\r\n      navigate(user?.role === 'MANAGER' ? '/manager' : user?.role === 'SECURITY_STAFF' ? '/staff' : '/dashboard');\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Failed to save details. Please try again.');\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  if (loading) return <div className=\"login-container\"><div className=\"login-card\">Loading‚Ä¶</div></div>;\r\n\r\n  return (\r\n    <div className=\"login-container\">\r\n      <div className=\"login-card\" style={{ maxWidth: 500 }}>\r\n        <div className=\"login-header\">\r\n          <h2>Welcome to PayrollGuard! üéâ</h2>\r\n          <p>Before you can access your dashboard, we need your baseline details. This information is required for payroll processing and will secure your account from unauthorized changes.</p>\r\n        </div>\r\n\r\n        {error && <div className=\"alert-error\" style={{ marginBottom: 20 }}>‚ö†Ô∏è {error}</div>}\r\n\r\n        <form className=\"login-form\" onSubmit={handleSubmit}>\r\n          \r\n          <h3 style={{ marginTop: 0, marginBottom: 16, fontSize: 16, color: '#f1f5f9', borderBottom: '1px solid #334155', paddingBottom: 8 }}>üè¶ Bank Details (Direct Deposit)</h3>\r\n          \r\n          <div className=\"form-group\">\r\n            <label>Account Number</label>\r\n            <input \r\n              type=\"text\" required placeholder=\"Account number\"\r\n              value={bank.accountNumber} onChange={e => setBank({...bank, accountNumber: e.target.value})} \r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label>Routing Number</label>\r\n            <input \r\n              type=\"text\" required placeholder=\"9-digit routing number\"\r\n              value={bank.routingNumber} onChange={e => setBank({...bank, routingNumber: e.target.value})} \r\n            />\r\n          </div>\r\n          <div className=\"form-group\" style={{ marginBottom: 32 }}>\r\n            <label>Bank Name (Optional)</label>\r\n            <input \r\n              type=\"text\" placeholder=\"e.g. Chase\"\r\n              value={bank.bankName} onChange={e => setBank({...bank, bankName: e.target.value})} \r\n            />\r\n          </div>\r\n\r\n          <h3 style={{ marginTop: 0, marginBottom: 16, fontSize: 16, color: '#f1f5f9', borderBottom: '1px solid #334155', paddingBottom: 8 }}>üìç Mailing Address</h3>\r\n\r\n          <div className=\"form-group\">\r\n            <label>Street Address</label>\r\n            <input \r\n              type=\"text\" required placeholder=\"123 Main St\"\r\n              value={address.street} onChange={e => setAddress({...address, street: e.target.value})} \r\n            />\r\n          </div>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12 }}>\r\n            <div className=\"form-group\">\r\n              <label>City</label>\r\n              <input \r\n                type=\"text\" required placeholder=\"City\"\r\n                value={address.city} onChange={e => setAddress({...address, city: e.target.value})} \r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label>State</label>\r\n              <input \r\n                type=\"text\" required placeholder=\"State (e.g. NY)\" maxLength={2}\r\n                value={address.state} onChange={e => setAddress({...address, state: e.target.value})} \r\n              />\r\n            </div>\r\n          </div>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 12 }}>\r\n            <div className=\"form-group\" style={{ marginBottom: 24 }}>\r\n              <label>ZIP Code</label>\r\n              <input \r\n                type=\"text\" required placeholder=\"ZIP\"\r\n                value={address.zip} onChange={e => setAddress({...address, zip: e.target.value})} \r\n              />\r\n            </div>\r\n            <div className=\"form-group\" style={{ marginBottom: 24 }}>\r\n              <label>Country</label>\r\n              <input \r\n                type=\"text\" required placeholder=\"US\"\r\n                value={address.country} onChange={e => setAddress({...address, country: e.target.value})} \r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <button type=\"submit\" className=\"login-btn\" disabled={submitting}>\r\n            {submitting ? '‚è≥ Saving...' : 'Complete Setup'}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Onboarding;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\PayrollDashboard.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":55,"column":37,"nodeType":"ArrayExpression","endLine":55,"endColumn":66,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData, selectedCycle, statusFilter]","fix":{"range":[1934,1963],"text":"[fetchData, selectedCycle, statusFilter]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport api from '../api/axios';\r\nimport Navbar from '../components/Navbar';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport './Dashboard.css';\r\nimport './Payroll.css';\r\n\r\nconst STATUS_META = {\r\n  PAID:    { label: 'PAID',    color: '#22c55e', icon: '‚úÖ' },\r\n  HELD:    { label: 'HELD',    color: '#ef4444', icon: 'üî¥' },\r\n  PENDING: { label: 'PENDING', color: '#f59e0b', icon: '‚è≥' },\r\n  CANCELLED: { label: 'CANCELLED', color: '#64748b', icon: 'üö´' },\r\n};\r\n\r\nconst PayrollDashboard = () => {\r\n  const { user } = useAuth();\r\n  const isManager = user?.role === 'manager' || user?.role === 'admin';\r\n\r\n  const [payrolls, setPayrolls] = useState([]);\r\n  const [stats, setStats]       = useState(null);\r\n  const [cycles, setCycles]     = useState([]);\r\n  const [selectedCycle, setSelectedCycle] = useState('');\r\n  const [statusFilter, setStatusFilter]   = useState('');\r\n  const [loading, setLoading]   = useState(true);\r\n  const [running, setRunning]   = useState(false);\r\n  const [msg, setMsg]           = useState('');\r\n  const [error, setError]       = useState('');\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      if (isManager) {\r\n        const params = {};\r\n        if (selectedCycle) params.cycleId = selectedCycle;\r\n        if (statusFilter)  params.status  = statusFilter;\r\n        const [payRes, statRes, cycleRes] = await Promise.all([\r\n          api.get('/payroll', { params }),\r\n          api.get('/payroll/stats'),\r\n          api.get('/payroll/cycles'),\r\n        ]);\r\n        setPayrolls(payRes.data.payrolls);\r\n        setStats(statRes.data);\r\n        setCycles(cycleRes.data.cycles);\r\n      } else {\r\n        const { data } = await api.get('/payroll/my');\r\n        setPayrolls(data.payrolls);\r\n      }\r\n    } catch {\r\n      setPayrolls([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => { fetchData(); }, [selectedCycle, statusFilter]);\r\n\r\n  const handleRunPayroll = async () => {\r\n    setRunning(true);\r\n    setError('');\r\n    setMsg('');\r\n    try {\r\n      const { data } = await api.post('/payroll/run', { defaultAmount: 3500 });\r\n      setMsg(`‚úÖ Payroll cycle ${data.results.cycleId} complete ‚Äî ${data.results.paid} paid, ${data.results.held} held.`);\r\n      fetchData();\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Payroll run failed.');\r\n    } finally {\r\n      setRunning(false);\r\n      setTimeout(() => { setMsg(''); setError(''); }, 5000);\r\n    }\r\n  };\r\n\r\n  const handleRelease = async (id) => {\r\n    try {\r\n      await api.put(`/payroll/${id}/release`, { note: 'Manually released via dashboard.' });\r\n      fetchData();\r\n    } catch (err) {\r\n      setError(err.response?.data?.message || 'Release failed.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <div className=\"dashboard-container\">\r\n        <div className=\"dashboard-header\">\r\n          <div>\r\n            <h2>üí∞ {isManager ? 'Payroll Control Center' : 'My Payroll History'}</h2>\r\n            <p>{isManager\r\n              ? 'Automated payroll runs on the 1st & 15th. Review and release held payments.'\r\n              : 'Your payroll history ‚Äî held payments require attention from your manager.'}\r\n            </p>\r\n          </div>\r\n          {isManager && (\r\n            <button className=\"btn-run-payroll\" onClick={handleRunPayroll} disabled={running}>\r\n              {running ? '‚è≥ Running‚Ä¶' : '‚ñ∂ Run Payroll Now'}\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {msg   && <div className=\"alert-success\">{msg}</div>}\r\n        {error && <div className=\"alert-error\">‚ö†Ô∏è {error}</div>}\r\n\r\n        {/* Stats */}\r\n        {isManager && stats && (\r\n          <div className=\"stats-grid\" style={{ marginBottom: 24 }}>\r\n            <div className=\"stat-card blue\">\r\n              <span className=\"stat-num\">{stats.stats.total}</span>\r\n              <span className=\"stat-lbl\">Total Records</span>\r\n            </div>\r\n            <div className=\"stat-card green\">\r\n              <span className=\"stat-num\">{stats.stats.paid}</span>\r\n              <span className=\"stat-lbl\">Paid</span>\r\n            </div>\r\n            <div className=\"stat-card red\">\r\n              <span className=\"stat-num\">{stats.stats.held}</span>\r\n              <span className=\"stat-lbl\">Held (Blocked)</span>\r\n            </div>\r\n            <div className=\"stat-card amber\">\r\n              <span className=\"stat-num\">{stats.stats.pending}</span>\r\n              <span className=\"stat-lbl\">Pending</span>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Filters (manager only) */}\r\n        {isManager && (\r\n          <div className=\"payroll-filters\">\r\n            <select value={selectedCycle} onChange={(e) => setSelectedCycle(e.target.value)}>\r\n              <option value=\"\">All Cycles</option>\r\n              {cycles.map((c) => <option key={c} value={c}>{c}</option>)}\r\n            </select>\r\n            <select value={statusFilter} onChange={(e) => setStatusFilter(e.target.value)}>\r\n              <option value=\"\">All Statuses</option>\r\n              <option value=\"PAID\">PAID</option>\r\n              <option value=\"HELD\">HELD</option>\r\n              <option value=\"PENDING\">PENDING</option>\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        {/* Payroll Table */}\r\n        {loading ? (\r\n          <div className=\"loading-text\">Loading payroll records‚Ä¶</div>\r\n        ) : payrolls.length === 0 ? (\r\n          <div className=\"card empty-state\">\r\n            <p>üì≠ No payroll records found. Run a cycle or adjust filters.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"card\" style={{ padding: 0, overflow: 'hidden' }}>\r\n            <table className=\"payroll-table\">\r\n              <thead>\r\n                <tr>\r\n                  {isManager && <th>Employee</th>}\r\n                  <th>Cycle</th>\r\n                  <th>Pay Date</th>\r\n                  <th>Amount</th>\r\n                  <th>Bank Account</th>\r\n                  <th>Status</th>\r\n                  <th>Details</th>\r\n                  {isManager && <th>Action</th>}\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {payrolls.map((p) => {\r\n                  const meta = STATUS_META[p.status] || STATUS_META.PENDING;\r\n                  return (\r\n                    <tr key={p._id} className={p.status === 'HELD' ? 'row-held' : ''}>\r\n                      {isManager && (\r\n                        <td>\r\n                          <strong>{p.employeeId?.name}</strong>\r\n                          <br /><small>{p.employeeId?.email}</small>\r\n                        </td>\r\n                      )}\r\n                      <td><code>{p.cycleId}</code></td>\r\n                      <td>{new Date(p.payDate).toLocaleDateString()}</td>\r\n                      <td className=\"amount\">${p.amount?.toLocaleString()}</td>\r\n                      <td><code>{p.paidToBankAccount?.accountNumber || '‚Äî'}</code></td>\r\n                      <td>\r\n                        <span className=\"status-chip\" style={{ background: `${meta.color}22`, color: meta.color, borderColor: `${meta.color}55` }}>\r\n                          {meta.icon} {meta.label}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"hold-reason\">\r\n                        {p.holdReason\r\n                          ? <span title={p.holdReason}>üö® {p.holdReason.substring(0, 45)}‚Ä¶</span>\r\n                          : <span style={{ color: '#475569' }}>‚Äî</span>}\r\n                        {p.riskScoreAtProcessing > 0 && (\r\n                          <div><small style={{ color: '#ef4444' }}>Risk: {p.riskScoreAtProcessing}</small></div>\r\n                        )}\r\n                      </td>\r\n                      {isManager && (\r\n                        <td>\r\n                          {p.status === 'HELD' && (\r\n                            <button className=\"btn-approve\" style={{ padding: '6px 12px', fontSize: 12 }} onClick={() => handleRelease(p._id)}>\r\n                              Release\r\n                            </button>\r\n                          )}\r\n                        </td>\r\n                      )}\r\n                    </tr>\r\n                  );\r\n                })}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n\r\n        {/* Recent Cycles Summary */}\r\n        {isManager && stats?.recentCycles?.length > 0 && (\r\n          <div className=\"card\" style={{ marginTop: 24 }}>\r\n            <h3>üìä Recent Cycle Summary</h3>\r\n            <table className=\"risk-table\">\r\n              <thead><tr><th>Cycle</th><th>Total</th><th>Paid</th><th>Held</th><th>Hold Rate</th></tr></thead>\r\n              <tbody>\r\n                {stats.recentCycles.map((c) => (\r\n                  <tr key={c._id}>\r\n                    <td><code>{c._id}</code></td>\r\n                    <td>{c.total}</td>\r\n                    <td style={{ color: '#22c55e' }}>{c.paid}</td>\r\n                    <td style={{ color: '#ef4444' }}>{c.held}</td>\r\n                    <td>\r\n                      <span className=\"risk-chip\" style={{ background: c.held > 0 ? '#ef444422' : '#22c55e22', color: c.held > 0 ? '#ef4444' : '#22c55e', borderColor: c.held > 0 ? '#ef444444' : '#22c55e44' }}>\r\n                        {c.total > 0 ? Math.round((c.held / c.total) * 100) : 0}%\r\n                      </span>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PayrollDashboard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\PayrollSimulator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\src\\pages\\StaffDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\advai\\Desktop\\coding\\OpenTrust_Howard_heckethorn\\frontend\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]